<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>local storage example</title>
</head>
<body>
	<button id="reset">Reset</button>

	<div id="quiz-container" class="container">
		<div class="q" id="q1">
			<h1>How would you describe your toxic level?</h1>
			<label for="q1">I'm just honest</label>
			<input type="radio" name="q1" class="blue">
			<label for="q1">Only when I need to be</label>
			<input type="radio" name="q1" class="tomato milk mimic">
			<label for="q1">I'm not really toxic</label>
			<input type="radio" name="q1" class="red glass">
		</div>
		<div class="q" id="q2">
			<h1>What is your outtake on life?</h1>
			<label for="q2">go with the flow</label>
			<input type="radio" name="q2" class="tomato mimic">
			<label for="q2">i have strong goals i want to complete</label>
			<input type="radio" name="q2" class="blue">
			<label for="q2">i stress about it all the time</label>
			<input type="radio" name="q2" class="glass milk">
			<label for="q2">i'm not sure</label>
			<input type="radio" name="q2" class="red">
		</div>
		<button value="submit" id="quiz-button">submit</button>
	</div>

	<div id="journal-container" class="container invisible">
		<section id="journal-panel">
			<h1>Grow your frog!</h1>
			<p>Answer journal prompts and your frog will grow and develop with your responses.</p>
			<div class="q" id="1">
				<label for="1">what is your favorite color?</label>
				<textarea name="1"></textarea>
				<button value="submit">submit</button>
			</div>
			<div class="q invisible" id="2">
				<label for="2">what is your favorite number?</label>
				<textarea name="2"></textarea>
				<button value="submit">submit</button>
			</div>
			<div class="q invisible" id="3">
				<label for="3">what is your favorite breakfast cereal?</label>
				<textarea name="3"></textarea>
				<button value="submit">submit</button>
			</div>
		</section>
		<section id="frog-panel">
			<img id="frog-img" src="https://media.istockphoto.com/id/172191851/photo/frog-spawn-in-a-puddle-next-to-a-trail.jpg?s=612x612&w=0&k=20&c=VxPQjoMS7MxWRdwRuL8pXoySAYRauWgsyw81wf8qLuk=" />
		</section>
		<section id="log-panel">
			<h1>Your journal entries</h1>
			<div id="entries">
				
			</div>
		</section>
	</div>

	<script>
		let quizContainer = document.getElementById("quiz-container");
		let journalContainer = document.getElementById("journal-container");

		let resetButton = document.getElementById("reset");
		resetButton.addEventListener("click", function() {
			localStorage.clear();
			quizContainer.classList.remove("invisible");
			journalContainer.classList.add("invisible");
		});

		///////////////////////////////////////////////////////////
		//
		// Which frog are you quiz
		//
		///////////////////////////////////////////////////////////

		let quizButton = document.getElementById("quiz-button");
		quizButton.addEventListener("click", function(b) {
			quizContainer.classList.toggle("invisible");
			journalContainer.classList.toggle("invisible");
		});

		///////////////////////////////////////////////////////////
		//
		// Journaling to evolve your frog
		//
		///////////////////////////////////////////////////////////
		
		// Assuming we want to loop questions, there should be the same number of frog images as there are questions. If we decide not to loop, code needs to be rewritten and there should be one more, ending with a landing page with full-grown frog. 
		let frogImgs = {
			1: "https://media.istockphoto.com/id/172191851/photo/frog-spawn-in-a-puddle-next-to-a-trail.jpg?s=612x612&w=0&k=20&c=VxPQjoMS7MxWRdwRuL8pXoySAYRauWgsyw81wf8qLuk=",
			2: "https://cdn.britannica.com/20/231520-050-9DF96017/tadpole-common-frog-amphibian.jpg",
			3: "https://i.natgeofe.com/k/8fa25ea4-6409-47fb-b3cc-4af8e0dc9616/red-eyed-tree-frog-on-leaves-3-2_3x2.jpg",
			// 4: "https://www.timeforkids.com/wp-content/uploads/2018/03/frog2.jpg?w=1024" 
		}

		// Grab all the questions from the page
		let qs = document.getElementsByClassName("q");

		function fetchLocalStorage(key) {
			if (localStorage.getItem(key) === null) {
				return "";
			} else {
				return localStorage.getItem(key);
			};
		}

		window.addEventListener("load", (e) => {
			let journalStorage = fetchLocalStorage("journal");
			document.getElementById("entries").innerHTML = journalStorage;
		});

		// For each question
		Array.from(qs).forEach((q,i) => {
			// Grab its button
			let button = q.childNodes[5];
			// And generate its index number, starting with 1
			let n = i+1;
			// Add a click-based event listener to the button
			button.addEventListener("click", function(b) {
				// If there is content in the button's associated text area
				if (b.srcElement.previousElementSibling.value != "") {
					// Get the current date and time and use it to create a log entry title 
					let date = new Date(Date.now()).toLocaleString();
					let entryTitle = document.createElement("h2");
					entryTitle.innerHTML = date;

					// Grab the current textarea input and use it to create a log entry, and then delete the input so it will be empty next time   
					let content = b.srcElement.previousElementSibling.value;
					b.srcElement.previousElementSibling.value = "";
					let entryContent = document.createElement("p");
					entryContent.classList.add("entry");
					entryContent.innerHTML = content;

					// Store the date into local storage by appending to a string we can decode when you return to the page, so the current state can persist
					let journalStorage = fetchLocalStorage("journal");
					let newJournalStorageEntry = entryTitle.outerHTML + entryContent.outerHTML;
					localStorage.setItem("journal",journalStorage + newJournalStorageEntry);

					//Then grab the whole log and append the entry title and content
					let log = document.getElementById("entries");
					log.appendChild(entryTitle)
					log.appendChild(entryContent);

					// Next hide the current question
					document.getElementById(n).classList.toggle("invisible");
					// If there are more questions in the questions list
					if (n+1 <= qs.length) {
						// Then show the next question and progress to the next frog image
						document.getElementById(n+1).classList.toggle("invisible");
						document.getElementById("frog-img").src = frogImgs[n+1];
					// If we're at the last question in the list
					} else {
						// Then loop back around to the first question and frog image
						document.getElementById(1).classList.toggle("invisible");
						document.getElementById("frog-img").src = frogImgs[1];
					}
				};

				console.log("local storage for journal key is now: " + localStorage.getItem("journal"))
			});
		})
	</script>

	<style>
		.q.invisible, #journal-container.invisible,#quiz-container.invisible {
			display:none;
		}
		#reset {
			position:fixed;
			top:24px;
			right:24px;
		}
		#journal-container {
			display:grid;
			grid-template-areas: 
				"journal frog"
				"log log";
			gap:24px;
		}
		#journal-panel {
			grid-area:journal;
			background-color:lightpink;
		}
		#frog-panel {
			grid-area:frog;
			background-color:lightgreen;
		}
		#log-panel {
			grid-area:log;
			background-color:lightblue;
		}
		img {
			max-width:100%;
		}
		section, .q {
			display:flex;
			flex-direction:column;
		}
		.q {
			padding-bottom:12px;
		}
		textarea {
			position:block;
			height:100px;
			width:40%;
		}
		button {
			width:200px;
		}
	</style>

</body>
</html>